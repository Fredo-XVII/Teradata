-- ALIGNS THE DATE TIME SERIES IN ORDER FUTURE AD-AD WEEKS
-- THIS IS AWESOME!! BECAUSE IT LINES UP THE TIME SERIES AS IT SHOULD BE FOR FORECAST MODELING
-- DO NOT REMOVE THE COMMENTED LINES, IN ORDER TO COME BACK AND DO RESEARCH AND UNDERSTAND WHAT IS GOING ON.

SELECT CAL_1.ACCT_YR_I,
	CAL_1.ACCT_WK_END_D, CAL_1.ACCT_WK_I, 
	-- CAL_1.PRYR_AD_WK_END_D, CAL_1.PRYR_AD_WK_I, 
	-- CAL_1.PRYR_ACCT_WK_END_D,
	-- 'XXXXXX' AS Marker1,
	-- CAL_2.ACCT_WK_END_D, CAL_2.ACCT_WK_I AS ACCT_WK_I_2, 
	-- CAL_2.PRYR_AD_WK_END_D, CAL_2.PRYR_AD_WK_I AS PRYR_AD_WK_I_2, 
	-- CAL_2.PRYR_ACCT_WK_END_D,
	
	COALESCE(CAL_2.PRYR_ACCT_WK_END_D, CAL_1.ACCT_WK_END_D) AS TS_ACCT_WK_END_D,
	COALESCE(CAL_2.ACCT_WK_I, CAL_1.ACCT_WK_I) AS TS_ACCT_WK_I
	

FROM SCHEMA.CAL_WK_DIM_V AS CAL_1
LEFT JOIN SCHEMA.CAL_WK_DIM_V AS CAL_2
 ON CAL_1.ACCT_WK_END_D = CAL_2.PRYR_AD_WK_END_D
 
WHERE CAL_1.ACCT_WK_END_D BETWEEN DATE '2015-02-07'  AND CURRENT_DATE + 180
AND TS_ACCT_WK_I <> 53
ORDER BY CAL_1.ACCT_WK_END_D
